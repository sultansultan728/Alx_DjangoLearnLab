<!-- blog/templates/blog/post_list.html -->
{% extends "blog/base.html" %}
{% block title %}Posts - My Blog{% endblock %}
{% block content %}
  <h1 class="text-3xl font-bold mb-6">All Posts</h1>

  {% for post in posts %}
    <article class="bg-white rounded shadow p-4 mb-4">
      <h2 class="text-2xl font-semibold">
        <a href="{% url 'post-detail' post.pk %}">{{ post.title }}</a>
      </h2>
      <p class="text-sm text-gray-500">By {{ post.author }} — {{ post.published_date|date:"M d, Y H:i" }}</p>
      <p class="mt-3">{{ post.content|truncatechars:200 }}</p>
      <div class="mt-3">
        <a href="{% url 'post-detail' post.pk %}" class="text-blue-600">Read more →</a>
        {% if user == post.author %}
          <a href="{% url 'post-update' post.pk %}" class="ml-4 text-yellow-600">Edit</a>
          <a href="{% url 'post-delete' post.pk %}" class="ml-4 text-red-600">Delete</a>
        {% endif %}
      </div>
    </article>
  {% empty %}
    <p>No posts yet. {% if user.is_authenticated %}<a href="{% url 'post-create' %}">Create one</a>.{% endif %}</p>
  {% endfor %}

  {% if is_paginated %}
    <div class="mt-6">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
      {% endif %}
      <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">Next</a>
      {% endif %}
    </div>
  {% endif %}
{% endblock %}

<div class="mt-2">
  {% for tag in post.tags.all %}
    <a href="{% url 'posts-by-tag' tag.name %}" class="text-sm bg-gray-100 px-2 py-1 rounded mr-2">#{{ tag.name }}</a>
  {% empty %}
    <span class="text-gray-400">No tags</span>
  {% endfor %}
</div>
